<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <title>V√§lj f√∂retag ‚Äì Tidrapporteringssystem</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f3f4f6;
    }

    .card {
      width: 100%;
      max-width: 520px;
      background: #ffffff;
      border-radius: 18px;
      padding: 32px 32px 28px;
      box-shadow: 0 20px 45px rgba(15, 23, 42, 0.18);
      text-align: left;
    }

    .system-title {
      text-align: center;
      margin-bottom: 24px;
    }

    .system-title h1 {
      margin: 8px 0 0;
      font-size: 22px;
    }

    .system-title p {
      margin: 4px 0 0;
      font-size: 13px;
      color: #6b7280;
    }

    .welcome-title {
      font-size: 18px;
      margin: 0 0 4px;
    }

    .welcome-sub {
      margin: 0 0 18px;
      font-size: 13px;
      color: #6b7280;
    }

    label {
      display: block;
      margin-bottom: 6px;
      font-size: 13px;
      color: #374151;
    }

    select {
      width: 100%;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid #d1d5db;
      font-size: 14px;
      background: #fff;
      appearance: none;
    }

    .actions {
      display: flex;
      justify-content: flex-end;
      margin-top: 20px;
    }

    .btn-primary {
      padding: 10px 18px;
      border-radius: 999px;
      border: none;
      background: #1d4ed8;
      color: white;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
    }

    .btn-primary:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .footer {
      text-align: center;
      margin-top: 16px;
      font-size: 11px;
      color: #9ca3af;
    }
  </style>
</head>
<body>
  <div class="card">
    <div class="system-title">
      <div style="font-size:40px;">üìã</div>
      <h1>Tidrapporteringssystem</h1>
      <p>Logga in f√∂r att rapportera tid</p>
    </div>

    <h2 class="welcome-title">V√§lkommen</h2>
    <p class="welcome-sub">V√§lj ditt f√∂retag f√∂r att forts√§tta</p>

    <div>
      <label for="companySelect">V√§lj f√∂retag</label>
      <select id="companySelect">
        <option value="">V√§lj ditt f√∂retag</option>
        <option value="rail-work-ab" data-code="RWA" data-name="Rail Work AB">
          Rail Work AB (RWA)
        </option>
        <option value="rail-work-entreprenad-ab" data-code="RWEA" data-name="Rail Work Entreprenad AB">
          Rail Work Entreprenad AB (RWEA)
        </option>
      </select>
    </div>

    <div class="actions">
      <button class="btn-primary" id="continueBtn" disabled>Forts√§tt</button>
    </div>

    <div class="footer">Systemadministrat√∂r</div>
  </div>

  <script>
    const selectEl = document.getElementById("companySelect");
    const continueBtn = document.getElementById("continueBtn");

    (function autoRedirectIfCompanyAlreadyChosen() {
      const companyId = localStorage.getItem("company_id");
      const expire = parseInt(localStorage.getItem("company_expire") || "0", 10);
      const now = Date.now();

      if (companyId && expire && expire > now) {
        window.location.href = "login.html";
      }
    })();

    selectEl.addEventListener("change", () => {
      continueBtn.disabled = !selectEl.value;
    });

    continueBtn.addEventListener("click", () => {
      const option = selectEl.options[selectEl.selectedIndex];
      if (!option.value) return;

      const companyId = option.value;
      const companyName = option.dataset.name;
      const companyCode = option.dataset.code;

      const oneYearMs = 365 * 24 * 60 * 60 * 1000;
      const expireAt = Date.now() + oneYearMs;

      localStorage.setItem("company_id", companyId);
      localStorage.setItem("company_name", companyName);
      localStorage.setItem("company_code", companyCode);
      localStorage.setItem("company_expire", String(expireAt));

      localStorage.removeItem("token");
      localStorage.removeItem("user_id");
      localStorage.removeItem("user_name");
      localStorage.removeItem("user_email");

      window.location.href = "login.html";
    });
  </script>
</body>
</html>
